<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EdilPavia · Admin</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        * { margin:0; padding:0; box-sizing:border-box; }
        body { font-family:'Segoe UI',Roboto,sans-serif; background:#f0f4f8; }
        .login-container, .dashboard-container { max-width:1200px; margin:0 auto; padding:40px 20px; }
        .login-box { background:white; border-radius:40px; padding:48px; max-width:420px; margin:40px auto; box-shadow:0 20px 40px rgba(0,0,0,0.1); text-align:center; }
        .login-box h1 { color:#0b3b5c; margin-bottom:10px; }
        .form-group { margin-bottom:20px; text-align:left; }
        label { font-weight:600; color:#0b3b5c; display:block; margin-bottom:8px; }
        input { width:100%; padding:14px 18px; border:1px solid #d0ddee; border-radius:30px; font-size:1rem; }
        .btn { background:#f5a623; color:#0b3b5c; border:none; padding:14px; border-radius:60px; font-weight:700; font-size:1.1rem; cursor:pointer; width:100%; transition:0.2s; }
        .btn:hover { background:#e09112; }
        .error { color:#c00; margin-top:10px; }

        /* Dashboard */
        .dashboard-container { display:none; }
        .header-dash { display:flex; justify-content:space-between; align-items:center; background:white; padding:20px 30px; border-radius:60px; margin-bottom:30px; box-shadow:0 8px 20px rgba(0,0,0,0.02); }
        .logo-dash { display:flex; align-items:center; gap:10px; font-size:1.8rem; font-weight:600; color:#0b3b5c; }
        .btn-logout { background:#0b3b5c; color:white; padding:10px 22px; border-radius:40px; border:none; cursor:pointer; font-weight:600; }
        .services-list { background:white; border-radius:40px; padding:30px; box-shadow:0 20px 40px rgba(0,0,0,0.02); }
        .service-item-admin { display:flex; align-items:center; justify-content:space-between; padding:15px; border-bottom:1px solid #eef2f6; }
        .service-item-admin:last-child { border-bottom:none; }
        .service-info { display:flex; align-items:center; gap:20px; }
        .service-info i { font-size:1.8rem; color:#f5a623; width:40px; }
        .service-actions button { background:none; border:none; margin:0 5px; font-size:1.2rem; cursor:pointer; color:#4a5b68; transition:0.2s; }
        .service-actions button:hover { color:#f5a623; }
        .btn-add { background:#0b3b5c; color:white; padding:12px 25px; border-radius:60px; border:none; font-weight:600; margin-bottom:20px; cursor:pointer; }
        .modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); align-items:center; justify-content:center; }
        .modal-content { background:white; border-radius:40px; padding:40px; max-width:500px; width:90%; }
        .modal-content h3 { margin-bottom:20px; }
        .modal-content input, .modal-content textarea { width:100%; padding:12px; margin-bottom:15px; border:1px solid #d0ddee; border-radius:30px; }
        .modal-actions { display:flex; gap:10px; justify-content:flex-end; }
        .btn-save, .btn-cancel { padding:10px 25px; border-radius:60px; border:none; font-weight:600; cursor:pointer; }
        .btn-save { background:#f5a623; color:#0b3b5c; }
        .btn-cancel { background:#ddd; color:#333; }
        .icon-preview { font-size:2rem; margin-bottom:15px; color:#f5a623; }
    </style>
</head>
<body>
    <div class="login-container" id="loginContainer">
        <div class="login-box">
            <i class="fas fa-lock" style="font-size:3rem; color:#f5a623;"></i>
            <h1>Area Admin</h1>
            <p>Inserisci le credenziali per gestire il sito</p>
            <form id="loginForm">
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="password" placeholder="••••••••">
                </div>
                <button type="submit" class="btn">Accedi</button>
                <div class="error" id="loginError"></div>
            </form>
        </div>
    </div>

    <div class="dashboard-container" id="dashboardContainer">
        <div class="dashboard-container-inner">
            <div class="header-dash">
                <div class="logo-dash">
                    <i class="fas fa-helmet-safety"></i>
                    <span>EdilPavia Admin</span>
                </div>
                <button class="btn-logout" id="logoutBtn">Esci</button>
            </div>

            <div class="services-list">
                <h2 style="margin-bottom:20px;">Gestione Servizi</h2>
                <button class="btn-add" id="addServiceBtn"><i class="fas fa-plus"></i> Aggiungi servizio</button>
                <div id="servicesContainer"></div>
            </div>
        </div>
    </div>

    <!-- Modal per aggiungere/modificare servizio -->
    <div class="modal" id="serviceModal">
        <div class="modal-content">
            <h3 id="modalTitle">Aggiungi servizio</h3>
            <div class="icon-preview" id="iconPreview"><i class="fas fa-tools"></i></div>
            <input type="text" id="serviceIcon" placeholder="Icona (es. fas fa-hard-hat)" value="fas fa-tools">
            <input type="text" id="serviceTitle" placeholder="Titolo servizio">
            <textarea id="serviceDesc" placeholder="Descrizione breve" rows="3"></textarea>
            <div class="modal-actions">
                <button class="btn-save" id="saveServiceBtn">Salva</button>
                <button class="btn-cancel" id="cancelModalBtn">Annulla</button>
            </div>
        </div>
    </div>

    <script>
        // Password fissa (cambiala dopo)
        const ADMIN_PASSWORD = 'edil2025';

        // Servizi iniziali (se localStorage è vuoto)
        const defaultServices = [
            { icon: 'fas fa-hard-hat', title: 'Lavori edili', desc: 'Ristrutturazioni, murature, demolizioni.' },
            { icon: 'fas fa-th-large', title: 'Pavimentazioni interne', desc: 'Parquet, gres, ceramica, massetti.' },
            { icon: 'fas fa-faucet', title: 'Idraulica', desc: 'Riparazioni, installazione bagni, caldaie.' },
            { icon: 'fas fa-bolt', title: 'Elettricista', desc: 'Impianti nuovi, messa a norma, certificazioni.' },
            { icon: 'fas fa-paint-roller', title: 'Imbiancatura', desc: 'Tinteggiature, carte da parati, decorazioni.' },
            { icon: 'fas fa-wind', title: 'Condizionatori', desc: 'Installazione e manutenzione climatizzatori.' },
            { icon: 'fas fa-shield-alt', title: 'Antifurti', desc: 'Allarmi, videosorveglianza, domotica.' },
            { icon: 'fas fa-road', title: 'Pavimentazioni esterne', desc: 'Autobloccanti, resine, vialetti.' },
            { icon: 'fas fa-leaf', title: 'Giardinaggio', desc: 'Taglio erba, potature, progettazione.' },
            { icon: 'fas fa-toolbox', title: 'Altri lavori', desc: 'Serramenti, tetti, coibentazioni.' }
        ];

        // Carica servizi da localStorage o usa default
        let services = JSON.parse(localStorage.getItem('edilpavia_services')) || defaultServices;

        // Variabili per la modifica
        let editingIndex = -1;

        // Elementi DOM
        const loginContainer = document.getElementById('loginContainer');
        const dashboardContainer = document.getElementById('dashboardContainer');
        const loginForm = document.getElementById('loginForm');
        const loginError = document.getElementById('loginError');
        const logoutBtn = document.getElementById('logoutBtn');
        const servicesContainer = document.getElementById('servicesContainer');
        const addServiceBtn = document.getElementById('addServiceBtn');
        const serviceModal = document.getElementById('serviceModal');
        const modalTitle = document.getElementById('modalTitle');
        const serviceIcon = document.getElementById('serviceIcon');
        const serviceTitle = document.getElementById('serviceTitle');
        const serviceDesc = document.getElementById('serviceDesc');
        const saveServiceBtn = document.getElementById('saveServiceBtn');
        const cancelModalBtn = document.getElementById('cancelModalBtn');
        const iconPreview = document.getElementById('iconPreview');

        // Funzione per salvare servizi in localStorage
        function saveServices() {
            localStorage.setItem('edilpavia_services', JSON.stringify(services));
        }

        // Funzione per renderizzare la lista servizi
        function renderServices() {
            servicesContainer.innerHTML = '';
            services.forEach((service, index) => {
                const div = document.createElement('div');
                div.className = 'service-item-admin';
                div.innerHTML = `
                    <div class="service-info">
                        <i class="${service.icon}"></i>
                        <div>
                            <strong>${service.title}</strong>
                            <p style="color:#4a5b68; font-size:0.9rem;">${service.desc}</p>
                        </div>
                    </div>
                    <div class="service-actions">
                        <button onclick="editService(${index})"><i class="fas fa-edit"></i></button>
                        <button onclick="deleteService(${index})"><i class="fas fa-trash"></i></button>
                    </div>
                `;
                servicesContainer.appendChild(div);
            });
        }

        // Funzioni globali per i pulsanti
        window.editService = function(index) {
            editingIndex = index;
            const s = services[index];
            serviceIcon.value = s.icon;
            serviceTitle.value = s.title;
            serviceDesc.value = s.desc;
            iconPreview.innerHTML = `<i class="${s.icon}"></i>`;
            modalTitle.innerText = 'Modifica servizio';
            serviceModal.style.display = 'flex';
        };

        window.deleteService = function(index) {
            if (confirm('Eliminare questo servizio?')) {
                services.splice(index, 1);
                saveServices();
                renderServices();
            }
        };

        // Login
        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const pwd = document.getElementById('password').value;
            if (pwd === ADMIN_PASSWORD) {
                loginContainer.style.display = 'none';
                dashboardContainer.style.display = 'block';
                renderServices();
            } else {
                loginError.innerText = 'Password errata';
            }
        });

        // Logout
        logoutBtn.addEventListener('click', () => {
            dashboardContainer.style.display = 'none';
            loginContainer.style.display = 'block';
            document.getElementById('password').value = '';
            loginError.innerText = '';
        });

        // Aggiungi servizio
        addServiceBtn.addEventListener('click', () => {
            editingIndex = -1;
            serviceIcon.value = 'fas fa-tools';
            serviceTitle.value = '';
            serviceDesc.value = '';
            iconPreview.innerHTML = '<i class="fas fa-tools"></i>';
            modalTitle.innerText = 'Aggiungi servizio';
            serviceModal.style.display = 'flex';
        });

        // Anteprima icona
        serviceIcon.addEventListener('input', () => {
            iconPreview.innerHTML = `<i class="${serviceIcon.value}"></i>`;
        });

        // Salva (nuovo o modifica)
        saveServiceBtn.addEventListener('click', () => {
            const icon = serviceIcon.value.trim();
            const title = serviceTitle.value.trim();
            const desc = serviceDesc.value.trim();
            if (!icon || !title || !desc) {
                alert('Compila tutti i campi');
                return;
            }
            if (editingIndex === -1) {
                // Aggiungi
                services.push({ icon, title, desc });
            } else {
                // Modifica
                services[editingIndex] = { icon, title, desc };
            }
            saveServices();
            renderServices();
            serviceModal.style.display = 'none';
        });

        // Annulla modale
        cancelModalBtn.addEventListener('click', () => {
            serviceModal.style.display = 'none';
        });

        // Chiudi modale cliccando fuori
        window.addEventListener('click', (e) => {
            if (e.target === serviceModal) {
                serviceModal.style.display = 'none';
            }
        });

        // Se già loggato? No, parte dal login.
    </script>
</body>
</html>
